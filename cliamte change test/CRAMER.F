	PROGRAM CRAMER
	PARAMETER (N=40 ,K=10 ,NYEAR=1951)
	REAL *8 X(N,2),X1(N),X2(N),T(N)
	REAL *8 V1,V2,EQ1,EQ2,TT

	OPEN (1,FILE="YT.TXT")
	DO 	I=1,N
	READ (1,*) (X(I,J),J=1,2)
	ENDDO
	CLOSE(1)
	
	IF (K.EQ.5) THEN
	A=3.18
		ELSE IF (K.EQ.10) THEN
		A=2.31
			ELSE IF (K.EQ.15) THEN
			A=2.16
	ENDIF
	DO I=1,N
		X1(I)=X(I,2)
	ENDDO
	DO L=1,N-K+1
		DO I=1,K
			X2(I)=X(L+I-1,2)
		ENDDO

		CALL SVAR(X1,V1,N)
		CALL SAVAG(X1,EQ1,N)
		CALL SAVAG(X2,EQ2,K)

	TT=(EQ2-EQ1)/SQRT(V1)
	T(L)=TT*SQRT( K*(N-2)/(N-K*(1+TT)) )
	PRINT *,NYEAR+L-1
	
	ENDDO

	OPEN (2,FILE="CRAMER_T10.TXT")
	DO L=1,N-K+1
	WRITE (2,'(I4,3F18.6)') NYEAR+L-1,T(L),A,-A
	ENDDO
	CLOSE(2)

	END

	SUBROUTINE SVAR(X,V,K)
	REAL *8 X(K),V

		SUM=0
		DO I=1,K
		SUM=SUM+X(I)
		ENDDO
		AVAG=SUM/K
		VAR=0
		DO I=1,K
		VAR=VAR+(X(I)-AVAG)**2
		ENDDO
		V=VAR/K

	END

	SUBROUTINE SAVAG(X,EQ,K)
 	REAL *8 X(K),EQ

		SUMX=0
		DO I=1,K
		SUMX=SUMX+X(I)
		ENDDO
		EQ=SUMX/K

	END
